{%- comment -%}
Launchpad Grid Generator - Generates an 8x8 launchpad grid with customizable color presets.
Parameters: presets (required), rows (optional), include_right_buttons (optional), show_top (optional)
{%- endcomment -%}

{%- assign show_top = include.show_top | default: false -%}
{%- assign save_slots = "gray:2,blue:3,gray:2,gray:2,blue:3,gray:2,gray:2,gray:2" | split: "," -%}

{%- assign steps_r_1 = "cyan:3,cyan:1,cyan:1,cyan:3,orange:3,cyan:1,cyan:3,cyan:1" | split: "," -%}
{%- assign steps_r_2 = "cyan:1,cyan:3,cyan:1,cyan:1,cyan:3,cyan:1,green:3,cyan:1" | split: "," -%}
{%- assign steps_r_3 = "cyan:3,cyan:1,cyan:1,cyan:3,cyan:1,cyan:1,cyan:3,cyan:1" | split: "," -%}

{%- assign steps_4_floor_select_beat ="cyan:3,cyan:1,cyan:1,orange:2,cyan:3,cyan:1,cyan:1,cyan:1" |
split: "," -%}
{%- assign steps_4_floor = "cyan:3,cyan:1,cyan:1,cyan:1,cyan:3,cyan:1,cyan:1,cyan:1" | split: ","
-%}
{%- assign steps_4_floor_select ="cyan:3,cyan:1,cyan:1,cyan:1,gray:3,cyan:1,cyan:1,cyan:1" |
split: "," -%}
{%- assign value_chance =
"green:3,green:3,green:3,green:3,green:3,green:3,green:3,green:3,cyan:2,off,off,purple:3,orange:3,off,off,red:3" |
split: "," -%}

{%- assign empty_row_step = "cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,cyan:1" | split: ","
-%}
{%- assign empty_row_step_last_5 = "cyan:1,cyan:1,cyan:1,cyan:1,orange:2,off,off,off" | split: ","
-%}
{%- assign empty_row_step_last_8 = "cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,cyan:1,orange:2" |
split: "," -%}
{%- assign empty_row = "off,off,off,off,off,off,off,off" | split: "," - %}


{%- assign extra_row_empty = "off,off,off,off,off,off,cyan:3,red:1" | split: "," - %}
{%- assign extra_row_mutations_1 = "yellow:3,purple:1,purple:1,purple:1,purple:1,off,cyan:3,red:1" | split: "," - %}
{%- assign extra_row_mutations_2 = "purple:1,yellow:3,purple:1,purple:1,purple:1,off,cyan:3,red:1" | split: "," - %}
{%- assign extra_row_mutations_3 = "purple:1,purple:1,yellow:3,purple:1,purple:1,off,cyan:3,red:1" | split: "," - %}
{%- assign extra_row_mutations_4 = "purple:1,purple:1,purple:1,yellow:3,purple:1,off,cyan:3,red:1" | split: "," - %}
{%- assign extra_row_mutations_5 = "purple:1,purple:1,purple:1,purple:1,yellow:3,off,cyan:3,red:1" | split: "," - %}


{%- assign preset_names = include.presets | split: "," -%}
{%- assign max_rows = include.rows | default: 8 -%}
{%- assign show_right_buttons = include.include_right_buttons | default: true -%}
{%- assign page = include.page | default: -1 -%}
{%- assign subpage = include.subpage | default: -1 -%}
{%- assign all_colors = "" | split: "," -%}

{%- for preset_name in preset_names -%}
{%- assign preset_name = preset_name | strip -%}
{%- assign show_value_area = include.show_value_area | default: -1 -%}
{%- case preset_name -%}
{%- when "save_slots" -%}{%- assign current_preset = save_slots -%}
{%- when "value_area" -%}{%- assign current_preset = value_area -%}
{%- when "steps_r_1" -%}{%- assign current_preset = steps_r_1 -%}
{%- when "steps_r_2" -%}{%- assign current_preset = steps_r_2 -%}
{%- when "steps_r_3" -%}{%- assign current_preset = steps_r_3 -%}
{%- when "steps_4_floor_select" -%}{%- assign current_preset = steps_4_floor_select -%}
{%- when "steps_4_floor_select_beats" -%}{%- assign current_preset = steps_4_floor_select_beats -%}
{%- when "steps_4_floor" -%}{%- assign current_preset = steps_4_floor -%}
{%- when "empty_row_step" -%}{%- assign current_preset = empty_row_step -%}
{%- when "empty_row_step_last_5" -%}{%- assign current_preset = empty_row_step_last_5 -%}
{%- when "empty_row_step_last_8" -%}{%- assign current_preset = empty_row_step_last_8 -%}
{%- when "value_chance" -%}{%- assign current_preset = value_chance -%}
{%- when "extra_row_empty" -%}{%- assign current_preset = extra_row_empty -%}
{%- when "empty_row" -%}{%- assign current_preset = empty_row -%}
{%- when "extra_row_mutations_1" -%}{%- assign current_preset = extra_row_mutations_1 -%}
{%- when "extra_row_mutations_2" -%}{%- assign current_preset = extra_row_mutations_2 -%}
{%- when "extra_row_mutations_3" -%}{%- assign current_preset = extra_row_mutations_3 -%}
{%- when "extra_row_mutations_4" -%}{%- assign current_preset = extra_row_mutations_4 -%}
{%- when "extra_row_mutations_5" -%}{%- assign current_preset = extra_row_mutations_5 -%}
{%- else -%}{%- assign current_preset = "off,off,off,off,off,off,off,off" | split: "," -%}
{%- endcase -%}
{%- assign all_colors = all_colors | concat: current_preset -%}
{%- endfor -%}

{%- assign total_pads = all_colors.size -%}
{%- assign calculated_rows = total_pads | divided_by: 8.0 | ceil -%}
{%- if calculated_rows > max_rows -%}{%- assign rows_to_render = max_rows -%}
{%- else -%}{%- assign rows_to_render = calculated_rows -%}{%- endif -%}

<div class="launchpad-container">
    {%- if show_top -%}
    {% include launchpad-top-row.html page=page subpage=subpage %}
    {%- endif -%}
    {%- for row_index in (0..rows_to_render) -%}
    {%- assign row_num = row_index | plus: 0 -%}
    {%- if row_num < rows_to_render -%} {%- for col_index in (0..7) -%} {%- assign pad_index=row_num | times: 8 | plus:
        col_index -%} {%- comment -%} Check if we should override with yellow pads for show_value_area {%- endcomment
        -%} {%- assign use_yellow_override=false -%} {%- if show_value_area>= 0 and show_value_area < 15 -%} {%- if
            row_num==4 -%} {%- assign max_yellow_pads=show_value_area | plus: 1 -%} {%- if col_index < max_yellow_pads
            -%} {%- assign use_yellow_override=true -%} {%- endif -%} {%- endif -%} {%- if row_num==5 -%} {%- assign
            max_yellow_pads=show_value_area | minus: 8 -%} {%- if col_index < max_yellow_pads -%} {%- assign
            use_yellow_override=true -%} {%- endif -%} {%- endif -%} {%- endif -%} {%- if use_yellow_override -%} {%-
            assign color_name="yellow" -%} {%- assign intensity="3" -%} {%- elsif pad_index < all_colors.size -%} {%-
            assign color_entry=all_colors[pad_index] | strip -%} {%- if color_entry contains ":" -%} {%- assign
            color_parts=color_entry | split: ":" -%} {%- assign color_name=color_parts[0] | strip -%} {%- assign
            intensity=color_parts[1] | strip -%} {%- else -%} {%- assign color_name=color_entry -%} {%- assign
            intensity="3" -%} {%- endif -%} {%- else -%} {%- assign color_name="off" -%} {%- assign intensity="3" -%}
            {%- endif -%} {%- assign pad_classes="launchpad-pad pad-" | append: color_name -%} {%- unless
            color_name=="off" -%} {%- assign pad_classes=pad_classes | append: " intensity-" | append: intensity -%} {%-
            endunless -%} <div class="{{ pad_classes }}">
</div>
{%- endfor -%}
{%- if show_right_buttons -%}
{%- if row_num == rows_to_render | minus: 1 -%}
<div class="launchpad-button launchpad-right-button launchpad-stop-solo-mute"></div>
{%- else -%}
<div class="launchpad-button launchpad-right-button launchpad-arrow-button"></div>
{%- endif -%}
{%- endif -%}
{%- endif -%}
{%- endfor -%}
</div>